# AGENTS.md — Codex Default规约 (Just Photo)

## 目标
把串行闭环 "拆解 → 分阶段实现 → 验证 → 存档" 改造成可并行的 3~5 线程协作流程，并默认生效。

## 默认输出要求（每次任务必须输出）
1. **任务拆解**：阶段边界 + 依赖关系
2. **每阶段验收点**：可执行、可观测
3. **验证方式**：Xcode / xcodebuild / 日志探针
4. **存档清单与位置**：写入 `memory-bank/`

## 执行规则
- **不反复追问**：缺信息时做最安全默认假设，并在 “Assumptions” 小节列清楚。
- **胶水编程优先**：优先复用系统/标准库/现有代码，不引入新三方依赖。
- **最小改动**：只改必须的文件与最小范围。
- **架构一致性**：遵守 `memory-bank/architecture.md` 的结构约束。
- **日志可审计**：关键路径必须可通过日志或探针验证。

## 并行智能体工作流（默认启用）
- **Planner**：负责任务拆解、阶段边界、依赖与风险；不写业务代码。
- **Implementer A/B**：各自负责分配的阶段实现；不跨阶段扩展需求。
- **Tester**：负责验证策略、测试命令与探针；不修改功能逻辑。
- **Archivist**：负责变更记录、Changelog/PR 描述草稿与 `memory-bank/` 归档；不改功能代码。

### 并行协作约定
- Planner 先产出阶段拆解与验收点，其他线程以此为单一事实源。
- 实现线程只在被分配的阶段内改动；跨阶段必须回到 Planner 重新切分。
- Tester 只汇总并执行验证；不在实现阶段引入新逻辑。
- Archivist 只做记录与归档；不参与实现。

## 输出模板（强制结构）
- **Task Breakdown**：阶段边界 + 依赖关系
- **Acceptance Criteria**：每阶段可执行/可观测验收点
- **Verification Plan**：Xcode / xcodebuild / 日志探针
- **Archive Plan**：要写入 `memory-bank/` 的清单与路径
- **Assumptions**：缺信息时的最安全默认假设
